<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2024-05-29T21:12:28.0843206"><title>10.2 Migracija Baze Podataka i Prototip Chat Sesija | ForgeAI Dokumentacija</title><script type="application/json" id="virtual-toc-data">[{"id":"migracija-baze-podataka","level":0,"title":"Migracija baze podataka","anchor":"#migracija-baze-podataka"},{"id":"unapre-enja-django-aplikacije","level":0,"title":"Unapređenja Django aplikacije","anchor":"#unapre-enja-django-aplikacije"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b259/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="10.2 Migracija Baze Podataka i Prototip Chat Sesija | ForgeAI Dokumentacija"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="ForgeAI Dokumentacija Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/migracija-baze-podataka-i-prototip-chat-sesija.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="10.2 Migracija Baze Podataka i Prototip Chat Sesija | ForgeAI Dokumentacija"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/migracija-baze-podataka-i-prototip-chat-sesija.html#webpage",
    "url": "writerside-documentation/migracija-baze-podataka-i-prototip-chat-sesija.html",
    "name": "10.2 Migracija Baze Podataka i Prototip Chat Sesija | ForgeAI Dokumentacija",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "ForgeAI Dokumentacija Help"
}</script><!-- End Schema.org --></head><body data-id="Migracija-Baze-Podataka-i-Prototip-Chat-Sesija" data-main-title="10.2 Migracija Baze Podataka i Prototip Chat Sesija" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Implementacija-Koda.md|10. Implementacija Koda"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>ForgeAI Dokumentacija  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Migracija-Baze-Podataka-i-Prototip-Chat-Sesija" id="Migracija-Baze-Podataka-i-Prototip-Chat-Sesija.md">10.2 Migracija Baze Podataka i Prototip Chat Sesija</h1><section class="chapter"><h2 id="migracija-baze-podataka" data-toc="migracija-baze-podataka">Migracija baze podataka</h2><section class="chapter"><h3 id="integracija-supabase-a" data-toc="integracija-supabase-a">Integracija Supabase-a</h3><p id="sbyxxm_616">U <code class="code" id="sbyxxm_617">settings.py</code> datoteci, postavke baze podataka su ažurirane kako bi koristile Supabase:</p><div class="code-block" data-lang="python">
DATABASES = {
    'default': {
        'ENGINE': os.environ['ENGINE'],
        'HOST': os.environ['HOST'],
        'NAME': os.environ['NAME'],
        'USER': os.environ['USER'],
        'PASSWORD': os.environ['PASSWORD'],
        'PORT': os.environ['PORT'],
    }
}
</div><p id="sbyxxm_619">Ove postavke povlače konfiguraciju baze podataka iz varijabli okruženja pohranjenih u <code class="code" id="sbyxxm_620">.env</code> datoteci. Ova promjena omogućava Django aplikaciji da se poveže sa Supabase PostgreSQL bazom podataka.</p></section><section class="chapter"><h3 id="tabela-sa-detaljima-korisnika" data-toc="tabela-sa-detaljima-korisnika">Tabela sa detaljima korisnika</h3><p id="sbyxxm_621">Supabase ima tabelu <code class="code" id="sbyxxm_622">auth.users</code> za autentifikaciju, koja pohranjuje osnovne informacije o korisnicima kao &scaron;to su email i enkriptovane lozinke. Međutim, nedostaju polja za dodatne informacije o korisnicima. Da bi se to rije&scaron;ilo, kreirana je nova tabela pod nazivom <code class="code" id="sbyxxm_623">user_detalji</code>:</p><div class="code-block" data-lang="sql">
create table public.user_detalji (
  id bigint generated by default as identity,
  created_at timestamp with time zone not null default now(),
  ime character varying not null,
  prezime character varying not null,
  user_id uuid null,
  constraint user_detalji_pkey primary key (id),
  constraint user_detalji_user_id_fkey foreign key (user_id) references auth.users (id) on delete cascade
) tablespace pg_default;
</div><p id="sbyxxm_625">Ova tabela uključuje:</p><ul class="list _bullet" id="sbyxxm_626"><li class="list__item" id="sbyxxm_627"><p><code class="code" id="sbyxxm_628">id</code>: Primarni ključ.</p></li><li class="list__item" id="sbyxxm_629"><p><code class="code" id="sbyxxm_630">created_at</code>: Vrijeme kreiranja zapisa.</p></li><li class="list__item" id="sbyxxm_631"><p><code class="code" id="sbyxxm_632">ime</code> i <code class="code" id="sbyxxm_633">prezime</code>: Ime i prezime korisnika.</p></li><li class="list__item" id="sbyxxm_634"><p><code class="code" id="sbyxxm_635">user_id</code>: Strani ključ koji povezuje sa <code class="code" id="sbyxxm_636">auth.users</code>.</p></li></ul></section><section class="chapter"><h3 id="tabela-sesija-eta" data-toc="tabela-sesija-eta">Tabela sesija četa</h3><p id="sbyxxm_637">Da bi se upravljalo sesijama četa, kreirana je tabela pod nazivom <code class="code" id="sbyxxm_638">chat_sesije</code>:</p><div class="code-block" data-lang="sql">
create table public.chat_sesije (
  id bigint generated by default as identity,
  created_at timestamp with time zone not null default now(),
  sesija_ime character varying not null,
  user_id uuid not null,
  constraint chat_sesije_pkey primary key (id),
  constraint chat_sesije_user_id_fkey foreign key (user_id) references auth.users (id) on delete cascade
) tablespace pg_default;
</div><p id="sbyxxm_640">Ova tabela uključuje:</p><ul class="list _bullet" id="sbyxxm_641"><li class="list__item" id="sbyxxm_642"><p><code class="code" id="sbyxxm_643">id</code>: Primarni ključ.</p></li><li class="list__item" id="sbyxxm_644"><p><code class="code" id="sbyxxm_645">created_at</code>: Vrijeme kreiranja sesije.</p></li><li class="list__item" id="sbyxxm_646"><p><code class="code" id="sbyxxm_647">sesija_ime</code>: Naziv sesije četa.</p></li><li class="list__item" id="sbyxxm_648"><p><code class="code" id="sbyxxm_649">user_id</code>: Strani ključ koji povezuje sa <code class="code" id="sbyxxm_650">auth.users</code>.</p></li></ul></section><section class="chapter"><h3 id="tabela-poruka" data-toc="tabela-poruka">Tabela poruka</h3><p id="sbyxxm_651">Za pohranu poruka razmijenjenih tokom sesija četa, kreirana je tabela pod nazivom <code class="code" id="sbyxxm_652">poruke</code>:</p><div class="code-block" data-lang="sql">
create table public.poruke (
  id bigint generated by default as identity,
  created_at timestamp with time zone not null default now(),
  chat_sesija_id bigint not null,
  poruka_text text not null,
  je_korisnik boolean not null default true,
  constraint poruke_pkey primary key (id),
  constraint poruke_chat_sesija_id_fkey foreign key (chat_sesija_id) references chat_sesije (id) on delete cascade
) tablespace pg_default;
</div><p id="sbyxxm_654">Ova tabela uključuje:</p><ul class="list _bullet" id="sbyxxm_655"><li class="list__item" id="sbyxxm_656"><p><code class="code" id="sbyxxm_657">id</code>: Primarni ključ.</p></li><li class="list__item" id="sbyxxm_658"><p><code class="code" id="sbyxxm_659">created_at</code>: Vrijeme kreiranja poruke.</p></li><li class="list__item" id="sbyxxm_660"><p><code class="code" id="sbyxxm_661">chat_sesija_id</code>: Strani ključ koji povezuje sa <code class="code" id="sbyxxm_662">chat_sesije</code>.</p></li><li class="list__item" id="sbyxxm_663"><p><code class="code" id="sbyxxm_664">poruka_text</code>: Sadržaj poruke.</p></li><li class="list__item" id="sbyxxm_665"><p><code class="code" id="sbyxxm_666">je_korisnik</code>: Booleova vrijednost koja označava da li je poruka od korisnika.</p></li></ul></section></section><section class="chapter"><h2 id="unapre-enja-django-aplikacije" data-toc="unapre-enja-django-aplikacije">Unapređenja Django aplikacije</h2><section class="chapter"><h3 id="bootstrap-stilizacija" data-toc="bootstrap-stilizacija">Bootstrap stilizacija</h3><p id="sbyxxm_667">Bootstrap stilizacija je dodana u HTML datoteke za prijavu i registraciju kako bi se pobolj&scaron;ao UI/UX.</p></section><section class="chapter"><h3 id="po-etna-stranica" data-toc="po-etna-stranica">Početna stranica</h3><p id="sbyxxm_668">Kreirana je privremena početna stranica koja služi kao ulazna tačka za aplikaciju.</p></section><section class="chapter"><h3 id="aplikacija-za-rukovanje-upitima" data-toc="aplikacija-za-rukovanje-upitima">Aplikacija za rukovanje upitima</h3><p id="sbyxxm_669">Kreirana je nova Django aplikacija pod nazivom <code class="code" id="sbyxxm_670">prompting_handler</code> za upravljanje upitima i pona&scaron;anjem chatbot-a.</p></section><section class="chapter"><h3 id="prikazi-i-forme" data-toc="prikazi-i-forme">Prikazi i forme</h3><section class="chapter"><h4 id="prikazi" data-toc="prikazi">Prikazi</h4><p id="sbyxxm_671"><a href="https://github.com/SafetImamovic/ForgeAI/blob/204b0333836cffa0203056fa6a9de14604ab3384/ForgeAI_django/prompting_handler/views.py" id="sbyxxm_672" data-external="true" rel="noopener noreferrer">Datoteka <code class="code" id="sbyxxm_673">views.py</code> u <code class="code" id="sbyxxm_674">prompting_handler</code> aplikaciji sadrži sljedeći kod</a></p><p id="sbyxxm_675">Objasnjenje:</p><ul class="list _bullet" id="sbyxxm_676"><li class="list__item" id="sbyxxm_677"><p><span class="control" id="sbyxxm_678">index</span>: Prikazuje listu sesija četa za prijavljenog korisnika.</p></li><li class="list__item" id="sbyxxm_679"><p><span class="control" id="sbyxxm_680">chat_session</span>: Prikazuje detalje određene sesije četa, uključujući poruke. Upravlja slanjem poruka i odgovorima bot-a.</p></li><li class="list__item" id="sbyxxm_681"><p><span class="control" id="sbyxxm_682">create_session</span>: Omogućava prijavljenim korisnicima da kreiraju novu sesiju četa.</p></li></ul></section><section class="chapter"><h4 id="url-ovi" data-toc="url-ovi">URL-ovi</h4><p id="sbyxxm_683">Datoteka <code class="code" id="sbyxxm_684">urls.py</code> za <code class="code" id="sbyxxm_685">prompting_handler</code> aplikaciju:</p><div class="code-block" data-lang="python">
from django.contrib import admin
from django.urls import path
from prompting_handler import views

urlpatterns = [
    path('', views.index, name='index'),
    path('session/&lt;int:session_id&gt;/', views.chat_session, name='chat_session'),
    path('create/', views.create_session, name='create_session'),
]
</div><p id="sbyxxm_687">Ovo postavlja rute za aplikaciju:</p><ul class="list _bullet" id="sbyxxm_688"><li class="list__item" id="sbyxxm_689"><p><code class="code" id="sbyxxm_690">/</code>: Prikazuje sesije četa.</p></li><li class="list__item" id="sbyxxm_691"><p><code class="code" id="sbyxxm_692">/session/&lt;int:session_id&gt;/</code>: Prikazuje određenu sesiju četa.</p></li><li class="list__item" id="sbyxxm_693"><p><code class="code" id="sbyxxm_694">/create/</code>: Kreira novu sesiju četa.</p></li></ul></section><section class="chapter"><h4 id="forma-za-at" data-toc="forma-za-at">Forma za čat</h4><p id="sbyxxm_695">Klasa <code class="code" id="sbyxxm_696">ChatForm</code> u <code class="code" id="sbyxxm_697">forms.py</code>:</p><div class="code-block" data-lang="python">
from django import forms

class ChatForm(forms.Form):
    user_input = forms.CharField(widget=forms.Textarea(attrs={&quot;rows&quot;: 3, &quot;cols&quot;: 40}))
</div><p id="sbyxxm_699">Objasnjenje:</p><ul class="list _bullet" id="sbyxxm_700"><li class="list__item" id="sbyxxm_701"><p>Defini&scaron;e formu sa jednim poljem <code class="code" id="sbyxxm_702">user_input</code>, prikazanim kao textarea za poruke korisnika.</p></li></ul></section></section><section class="chapter"><h3 id="klase-podataka" data-toc="klase-podataka">Klase podataka</h3><p id="sbyxxm_703">Dvije klase podataka, <code class="code" id="sbyxxm_704">Poruka</code> i <code class="code" id="sbyxxm_705">ChatSesija</code>, predstavljaju podatke dobijene iz baze podataka. One su definisane u <code class="code" id="sbyxxm_706">data_klase.py</code>:</p><div class="code-block" data-lang="python">
from dataclasses import dataclass
from typing import List

@dataclass
class Poruka:
    message_text: str
    is_user: bool
    timestamp: str

@dataclass
class ChatSesija:
    id: int
    session_name: str
    messages: List[Poruka]
    created_at: str
</div><p id="sbyxxm_708">Objasnjenje:</p><ul class="list _bullet" id="sbyxxm_709"><li class="list__item" id="sbyxxm_710"><p><span class="control" id="sbyxxm_711">Poruka</span>: Predstavlja poruku, uključujući tekst, po&scaron;iljaoca i vremensku oznaku.</p></li><li class="list__item" id="sbyxxm_712"><p><span class="control" id="sbyxxm_713">ChatSesija</span>: Predstavlja sesiju četa, uključujući njen ID, naziv, listu poruka i vremensku oznaku kreiranja.</p></li></ul></section><section class="chapter"><h3 id="html-predlo-ci" data-toc="html-predlo-ci">HTML predlo&scaron;ci</h3><section class="chapter"><h4 id="predlo-ak-za-sesiju-eta" data-toc="predlo-ak-za-sesiju-eta">Predložak za sesiju četa</h4><p id="sbyxxm_714"><a href="https://github.com/SafetImamovic/ForgeAI/blob/204b0333836cffa0203056fa6a9de14604ab3384/ForgeAI_django/prompting_handler/templates/chatbot/chat_session.html" id="sbyxxm_715" data-external="true" rel="noopener noreferrer"><code class="code" id="sbyxxm_716">chat_session.html</code></a></p><p id="sbyxxm_717">Objasnjenje:</p><ul class="list _bullet" id="sbyxxm_718"><li class="list__item" id="sbyxxm_719"><p>Prikazuje naziv sesije četa i poruke.</p></li><li class="list__item" id="sbyxxm_720"><p>Pruža formu za korisnika da po&scaron;alje nove poruke.</p></li><li class="list__item" id="sbyxxm_721"><p>Uključuje link za povratak na listu sesija četa.</p></li></ul></section><section class="chapter"><h4 id="predlo-ak-za-kreiranje-sesije" data-toc="predlo-ak-za-kreiranje-sesije">Predložak za kreiranje sesije</h4><p id="sbyxxm_722"><a href="https://github.com/SafetImamovic/ForgeAI/blob/204b0333836cffa0203056fa6a9de14604ab3384/ForgeAI_django/prompting_handler/templates/chatbot/create_session.html" id="sbyxxm_723" data-external="true" rel="noopener noreferrer"><code class="code" id="sbyxxm_724">create_session.html</code></a></p><p id="sbyxxm_725">Objasnjenje:</p><ul class="list _bullet" id="sbyxxm_726"><li class="list__item" id="sbyxxm_727"><p>Pruža formu za kreiranje nove sesije četa sa nazivom.</p></li><li class="list__item" id="sbyxxm_728"><p>Uključuje link za povratak na listu sesija četa.</p></li></ul></section><section class="chapter"><h4 id="indeks-predlo-ak" data-toc="indeks-predlo-ak">Indeks predložak</h4><p id="sbyxxm_729"><a href="https://github.com/SafetImamovic/ForgeAI/blob/204b0333836cffa0203056fa6a9de14604ab3384/ForgeAI_django/prompting_handler/templates/chatbot/index.html" id="sbyxxm_730" data-external="true" rel="noopener noreferrer"><code class="code" id="sbyxxm_731">index.html</code></a></p><p id="sbyxxm_732">Objasnjenje:</p><ul class="list _bullet" id="sbyxxm_733"><li class="list__item" id="sbyxxm_734"><p>Prikazuje listu sesija četa sa linkovima ka svakoj sesiji.</p></li><li class="list__item" id="sbyxxm_735"><p>Uključuje link za kreiranje nove sesije četa.</p></li></ul></section></section></section><div class="last-modified">Last modified: 29 May 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="postavka-projekta.html" class="navigation-links__prev">10.1 Postavke Projekta i Supabase Integracija</a><a href="implementacija-stripe-a.html" class="navigation-links__next">10.3 Implementacija Stripe-a</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b259/app.js"></script></body></html>