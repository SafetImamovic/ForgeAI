<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2024-06-01T00:50:00.409103"><title>10.2 Migracija Baze Podataka i Prototip Chat Sesija | ForgeAI Dokumentacija</title><script type="application/json" id="virtual-toc-data">[{"id":"migracija-baze-podataka","level":0,"title":"Migracija baze podataka","anchor":"#migracija-baze-podataka"},{"id":"unapre-enja-django-aplikacije","level":0,"title":"Unapređenja Django aplikacije","anchor":"#unapre-enja-django-aplikacije"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b259/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="10.2 Migracija Baze Podataka i Prototip Chat Sesija | ForgeAI Dokumentacija"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="ForgeAI Dokumentacija Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/migracija-baze-podataka-i-prototip-chat-sesija.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="10.2 Migracija Baze Podataka i Prototip Chat Sesija | ForgeAI Dokumentacija"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/migracija-baze-podataka-i-prototip-chat-sesija.html#webpage",
    "url": "writerside-documentation/migracija-baze-podataka-i-prototip-chat-sesija.html",
    "name": "10.2 Migracija Baze Podataka i Prototip Chat Sesija | ForgeAI Dokumentacija",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "ForgeAI Dokumentacija Help"
}</script><!-- End Schema.org --></head><body data-id="Migracija-Baze-Podataka-i-Prototip-Chat-Sesija" data-main-title="10.2 Migracija Baze Podataka i Prototip Chat Sesija" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Implementacija-Koda.md|10. Implementacija Koda"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>ForgeAI Dokumentacija  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Migracija-Baze-Podataka-i-Prototip-Chat-Sesija" id="Migracija-Baze-Podataka-i-Prototip-Chat-Sesija.md">10.2 Migracija Baze Podataka i Prototip Chat Sesija</h1><section class="chapter"><h2 id="migracija-baze-podataka" data-toc="migracija-baze-podataka">Migracija baze podataka</h2><section class="chapter"><h3 id="integracija-supabase-a" data-toc="integracija-supabase-a">Integracija Supabase-a</h3><p id="-ts4pfy_2">U <code class="code" id="-ts4pfy_3">settings.py</code> datoteci, postavke baze podataka su ažurirane kako bi koristile Supabase:</p><div class="code-block" data-lang="python">
DATABASES = {
    'default': {
        'ENGINE': os.environ['ENGINE'],
        'HOST': os.environ['HOST'],
        'NAME': os.environ['NAME'],
        'USER': os.environ['USER'],
        'PASSWORD': os.environ['PASSWORD'],
        'PORT': os.environ['PORT'],
    }
}
</div><p id="-ts4pfy_5">Ove postavke povlače konfiguraciju baze podataka iz varijabli okruženja pohranjenih u <code class="code" id="-ts4pfy_6">.env</code> datoteci. Ova promjena omogućava Django aplikaciji da se poveže sa Supabase PostgreSQL bazom podataka.</p></section><section class="chapter"><h3 id="tabela-sa-detaljima-korisnika" data-toc="tabela-sa-detaljima-korisnika">Tabela sa detaljima korisnika</h3><p id="-ts4pfy_7">Supabase ima tabelu <code class="code" id="-ts4pfy_8">auth.users</code> za autentifikaciju, koja pohranjuje osnovne informacije o korisnicima kao &scaron;to su email i enkriptovane lozinke. Međutim, nedostaju polja za dodatne informacije o korisnicima. Da bi se to rije&scaron;ilo, kreirana je nova tabela pod nazivom <code class="code" id="-ts4pfy_9">user_detalji</code>:</p><div class="code-block" data-lang="sql">
create table public.user_detalji (
  id bigint generated by default as identity,
  created_at timestamp with time zone not null default now(),
  ime character varying not null,
  prezime character varying not null,
  user_id uuid null,
  constraint user_detalji_pkey primary key (id),
  constraint user_detalji_user_id_fkey foreign key (user_id) references auth.users (id) on delete cascade
) tablespace pg_default;
</div><p id="-ts4pfy_11">Ova tabela uključuje:</p><ul class="list _bullet" id="-ts4pfy_12"><li class="list__item" id="-ts4pfy_13"><p><code class="code" id="-ts4pfy_14">id</code>: Primarni ključ.</p></li><li class="list__item" id="-ts4pfy_15"><p><code class="code" id="-ts4pfy_16">created_at</code>: Vrijeme kreiranja zapisa.</p></li><li class="list__item" id="-ts4pfy_17"><p><code class="code" id="-ts4pfy_18">ime</code> i <code class="code" id="-ts4pfy_19">prezime</code>: Ime i prezime korisnika.</p></li><li class="list__item" id="-ts4pfy_20"><p><code class="code" id="-ts4pfy_21">user_id</code>: Strani ključ koji povezuje sa <code class="code" id="-ts4pfy_22">auth.users</code>.</p></li></ul></section><section class="chapter"><h3 id="tabela-sesija-eta" data-toc="tabela-sesija-eta">Tabela sesija četa</h3><p id="-ts4pfy_23">Da bi se upravljalo sesijama četa, kreirana je tabela pod nazivom <code class="code" id="-ts4pfy_24">chat_sesije</code>:</p><div class="code-block" data-lang="sql">
create table public.chat_sesije (
  id bigint generated by default as identity,
  created_at timestamp with time zone not null default now(),
  sesija_ime character varying not null,
  user_id uuid not null,
  constraint chat_sesije_pkey primary key (id),
  constraint chat_sesije_user_id_fkey foreign key (user_id) references auth.users (id) on delete cascade
) tablespace pg_default;
</div><p id="-ts4pfy_26">Ova tabela uključuje:</p><ul class="list _bullet" id="-ts4pfy_27"><li class="list__item" id="-ts4pfy_28"><p><code class="code" id="-ts4pfy_29">id</code>: Primarni ključ.</p></li><li class="list__item" id="-ts4pfy_30"><p><code class="code" id="-ts4pfy_31">created_at</code>: Vrijeme kreiranja sesije.</p></li><li class="list__item" id="-ts4pfy_32"><p><code class="code" id="-ts4pfy_33">sesija_ime</code>: Naziv sesije četa.</p></li><li class="list__item" id="-ts4pfy_34"><p><code class="code" id="-ts4pfy_35">user_id</code>: Strani ključ koji povezuje sa <code class="code" id="-ts4pfy_36">auth.users</code>.</p></li></ul></section><section class="chapter"><h3 id="tabela-poruka" data-toc="tabela-poruka">Tabela poruka</h3><p id="-ts4pfy_37">Za pohranu poruka razmijenjenih tokom sesija četa, kreirana je tabela pod nazivom <code class="code" id="-ts4pfy_38">poruke</code>:</p><div class="code-block" data-lang="sql">
create table public.poruke (
  id bigint generated by default as identity,
  created_at timestamp with time zone not null default now(),
  chat_sesija_id bigint not null,
  poruka_text text not null,
  je_korisnik boolean not null default true,
  constraint poruke_pkey primary key (id),
  constraint poruke_chat_sesija_id_fkey foreign key (chat_sesija_id) references chat_sesije (id) on delete cascade
) tablespace pg_default;
</div><p id="-ts4pfy_40">Ova tabela uključuje:</p><ul class="list _bullet" id="-ts4pfy_41"><li class="list__item" id="-ts4pfy_42"><p><code class="code" id="-ts4pfy_43">id</code>: Primarni ključ.</p></li><li class="list__item" id="-ts4pfy_44"><p><code class="code" id="-ts4pfy_45">created_at</code>: Vrijeme kreiranja poruke.</p></li><li class="list__item" id="-ts4pfy_46"><p><code class="code" id="-ts4pfy_47">chat_sesija_id</code>: Strani ključ koji povezuje sa <code class="code" id="-ts4pfy_48">chat_sesije</code>.</p></li><li class="list__item" id="-ts4pfy_49"><p><code class="code" id="-ts4pfy_50">poruka_text</code>: Sadržaj poruke.</p></li><li class="list__item" id="-ts4pfy_51"><p><code class="code" id="-ts4pfy_52">je_korisnik</code>: Booleova vrijednost koja označava da li je poruka od korisnika.</p></li></ul></section></section><section class="chapter"><h2 id="unapre-enja-django-aplikacije" data-toc="unapre-enja-django-aplikacije">Unapređenja Django aplikacije</h2><section class="chapter"><h3 id="bootstrap-stilizacija" data-toc="bootstrap-stilizacija">Bootstrap stilizacija</h3><p id="-ts4pfy_53">Bootstrap stilizacija je dodana u HTML datoteke za prijavu i registraciju kako bi se pobolj&scaron;ao UI/UX.</p></section><section class="chapter"><h3 id="po-etna-stranica" data-toc="po-etna-stranica">Početna stranica</h3><p id="-ts4pfy_54">Kreirana je privremena početna stranica koja služi kao ulazna tačka za aplikaciju.</p></section><section class="chapter"><h3 id="aplikacija-za-rukovanje-upitima" data-toc="aplikacija-za-rukovanje-upitima">Aplikacija za rukovanje upitima</h3><p id="-ts4pfy_55">Kreirana je nova Django aplikacija pod nazivom <code class="code" id="-ts4pfy_56">prompting_handler</code> za upravljanje upitima i pona&scaron;anjem chatbot-a.</p></section><section class="chapter"><h3 id="prikazi-i-forme" data-toc="prikazi-i-forme">Prikazi i forme</h3><section class="chapter"><h4 id="prikazi" data-toc="prikazi">Prikazi</h4><p id="-ts4pfy_57"><a href="https://github.com/SafetImamovic/ForgeAI/blob/204b0333836cffa0203056fa6a9de14604ab3384/ForgeAI_django/prompting_handler/views.py" id="-ts4pfy_58" data-external="true" rel="noopener noreferrer">Datoteka <code class="code" id="-ts4pfy_59">views.py</code> u <code class="code" id="-ts4pfy_60">prompting_handler</code> aplikaciji sadrži sljedeći kod</a></p><p id="-ts4pfy_61">Objasnjenje:</p><ul class="list _bullet" id="-ts4pfy_62"><li class="list__item" id="-ts4pfy_63"><p><span class="control" id="-ts4pfy_64">index</span>: Prikazuje listu sesija četa za prijavljenog korisnika.</p></li><li class="list__item" id="-ts4pfy_65"><p><span class="control" id="-ts4pfy_66">chat_session</span>: Prikazuje detalje određene sesije četa, uključujući poruke. Upravlja slanjem poruka i odgovorima bot-a.</p></li><li class="list__item" id="-ts4pfy_67"><p><span class="control" id="-ts4pfy_68">create_session</span>: Omogućava prijavljenim korisnicima da kreiraju novu sesiju četa.</p></li></ul></section><section class="chapter"><h4 id="url-ovi" data-toc="url-ovi">URL-ovi</h4><p id="-ts4pfy_69">Datoteka <code class="code" id="-ts4pfy_70">urls.py</code> za <code class="code" id="-ts4pfy_71">prompting_handler</code> aplikaciju:</p><div class="code-block" data-lang="python">
from django.contrib import admin
from django.urls import path
from prompting_handler import views

urlpatterns = [
    path('', views.index, name='index'),
    path('session/&lt;int:session_id&gt;/', views.chat_session, name='chat_session'),
    path('create/', views.create_session, name='create_session'),
]
</div><p id="-ts4pfy_73">Ovo postavlja rute za aplikaciju:</p><ul class="list _bullet" id="-ts4pfy_74"><li class="list__item" id="-ts4pfy_75"><p><code class="code" id="-ts4pfy_76">/</code>: Prikazuje sesije četa.</p></li><li class="list__item" id="-ts4pfy_77"><p><code class="code" id="-ts4pfy_78">/session/&lt;int:session_id&gt;/</code>: Prikazuje određenu sesiju četa.</p></li><li class="list__item" id="-ts4pfy_79"><p><code class="code" id="-ts4pfy_80">/create/</code>: Kreira novu sesiju četa.</p></li></ul></section><section class="chapter"><h4 id="forma-za-at" data-toc="forma-za-at">Forma za čat</h4><p id="-ts4pfy_81">Klasa <code class="code" id="-ts4pfy_82">ChatForm</code> u <code class="code" id="-ts4pfy_83">forms.py</code>:</p><div class="code-block" data-lang="python">
from django import forms

class ChatForm(forms.Form):
    user_input = forms.CharField(widget=forms.Textarea(attrs={&quot;rows&quot;: 3, &quot;cols&quot;: 40}))
</div><p id="-ts4pfy_85">Objasnjenje:</p><ul class="list _bullet" id="-ts4pfy_86"><li class="list__item" id="-ts4pfy_87"><p>Defini&scaron;e formu sa jednim poljem <code class="code" id="-ts4pfy_88">user_input</code>, prikazanim kao textarea za poruke korisnika.</p></li></ul></section></section><section class="chapter"><h3 id="klase-podataka" data-toc="klase-podataka">Klase podataka</h3><p id="-ts4pfy_89">Dvije klase podataka, <code class="code" id="-ts4pfy_90">Poruka</code> i <code class="code" id="-ts4pfy_91">ChatSesija</code>, predstavljaju podatke dobijene iz baze podataka. One su definisane u <code class="code" id="-ts4pfy_92">data_klase.py</code>:</p><div class="code-block" data-lang="python">
from dataclasses import dataclass
from typing import List

@dataclass
class Poruka:
    message_text: str
    is_user: bool
    timestamp: str

@dataclass
class ChatSesija:
    id: int
    session_name: str
    messages: List[Poruka]
    created_at: str
</div><p id="-ts4pfy_94">Objasnjenje:</p><ul class="list _bullet" id="-ts4pfy_95"><li class="list__item" id="-ts4pfy_96"><p><span class="control" id="-ts4pfy_97">Poruka</span>: Predstavlja poruku, uključujući tekst, po&scaron;iljaoca i vremensku oznaku.</p></li><li class="list__item" id="-ts4pfy_98"><p><span class="control" id="-ts4pfy_99">ChatSesija</span>: Predstavlja sesiju četa, uključujući njen ID, naziv, listu poruka i vremensku oznaku kreiranja.</p></li></ul></section><section class="chapter"><h3 id="html-predlo-ci" data-toc="html-predlo-ci">HTML predlo&scaron;ci</h3><section class="chapter"><h4 id="predlo-ak-za-sesiju-eta" data-toc="predlo-ak-za-sesiju-eta">Predložak za sesiju četa</h4><p id="-ts4pfy_100"><a href="https://github.com/SafetImamovic/ForgeAI/blob/204b0333836cffa0203056fa6a9de14604ab3384/ForgeAI_django/prompting_handler/templates/chatbot/chat_session.html" id="-ts4pfy_101" data-external="true" rel="noopener noreferrer"><code class="code" id="-ts4pfy_102">chat_session.html</code></a></p><p id="-ts4pfy_103">Objasnjenje:</p><ul class="list _bullet" id="-ts4pfy_104"><li class="list__item" id="-ts4pfy_105"><p>Prikazuje naziv sesije četa i poruke.</p></li><li class="list__item" id="-ts4pfy_106"><p>Pruža formu za korisnika da po&scaron;alje nove poruke.</p></li><li class="list__item" id="-ts4pfy_107"><p>Uključuje link za povratak na listu sesija četa.</p></li></ul></section><section class="chapter"><h4 id="predlo-ak-za-kreiranje-sesije" data-toc="predlo-ak-za-kreiranje-sesije">Predložak za kreiranje sesije</h4><p id="-ts4pfy_108"><a href="https://github.com/SafetImamovic/ForgeAI/blob/204b0333836cffa0203056fa6a9de14604ab3384/ForgeAI_django/prompting_handler/templates/chatbot/create_session.html" id="-ts4pfy_109" data-external="true" rel="noopener noreferrer"><code class="code" id="-ts4pfy_110">create_session.html</code></a></p><p id="-ts4pfy_111">Objasnjenje:</p><ul class="list _bullet" id="-ts4pfy_112"><li class="list__item" id="-ts4pfy_113"><p>Pruža formu za kreiranje nove sesije četa sa nazivom.</p></li><li class="list__item" id="-ts4pfy_114"><p>Uključuje link za povratak na listu sesija četa.</p></li></ul></section><section class="chapter"><h4 id="indeks-predlo-ak" data-toc="indeks-predlo-ak">Indeks predložak</h4><p id="-ts4pfy_115"><a href="https://github.com/SafetImamovic/ForgeAI/blob/204b0333836cffa0203056fa6a9de14604ab3384/ForgeAI_django/prompting_handler/templates/chatbot/index.html" id="-ts4pfy_116" data-external="true" rel="noopener noreferrer"><code class="code" id="-ts4pfy_117">index.html</code></a></p><p id="-ts4pfy_118">Objasnjenje:</p><ul class="list _bullet" id="-ts4pfy_119"><li class="list__item" id="-ts4pfy_120"><p>Prikazuje listu sesija četa sa linkovima ka svakoj sesiji.</p></li><li class="list__item" id="-ts4pfy_121"><p>Uključuje link za kreiranje nove sesije četa.</p></li></ul></section></section></section><div class="last-modified">Last modified: 31 May 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="postavka-projekta.html" class="navigation-links__prev">10.1 Postavke Projekta i Supabase Integracija</a><a href="implementacija-stripe-a.html" class="navigation-links__next">10.3 Implementacija Stripe-a</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b259/app.js"></script></body></html>